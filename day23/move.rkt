#lang racket
(require "state.rkt")
(provide moves-from
         move-is-blocked
         from-val
         to-val
         num-steps)
#|
+-------------------------------------------+
| 0   1   2   3   4   5   6   7   8   9  10 |
+-----+  11   |  13   |  15   |  17   +-----+
      |  12   |  14   |  16   |  18   |
      +-------------------------------+

A move is a list of positions with the starting index first, the ending index first
therefore the start position is (first move)
end position is (last move)
number of steps to get from start to end is length - 1

|#

(define (from-val move)
  (first move))

(define (to-val move)
  (last move))

(define (num-steps move)
  (sub1 (length move)))

(define (moves-from-14)
  '((14 13 4 3 2 11 12)
    (14 13 4 3 2 11)
    (14 13)
    (14 13 4 5 6 15 16)
    (14 13 4 5 6 15)
    (14 13 4 5 6 7 8 17 18)
    (14 13 4 5 6 7 8 17)
    (14 13 4 3 2 1 0)
    (14 13 4 3 2 1)
    (14 13 4 3)
    (14 13 4 5)
    (14 13 4 5 6 7)
    (14 13 4 5 6 7 8 9)
    (14 13 4 5 6 7 8 9 10)))

(define (moves-from-13)
  '((13 4 3 2 11 12)
    (13 4 3 2 11)
    (13 14)
    (13 4 5 6 15 16)
    (13 4 5 6 15)
    (13 4 5 6 7 8 17 18)
    (13 4 5 6 7 8 17)
    (13 4 3 2 1 0)
    (13 4 3 2 1)
    (13 4 3)
    (13 4 5)
    (13 4 5 6 7)
    (13 4 5 6 7 8 9)
    (13 4 5 6 7 8 9 10)))

(define (moves-from-12)
  '((12 11)
    (12 11 2 3 4 13 14)
    (12 11 2 3 4 13)
    (12 11 2 3 4 5 6 15 16)
    (12 11 2 3 4 5 6 15)
    (12 11 2 3 4 5 6 7 8 17 18)
    (12 11 2 3 4 5 6 7 8 17)
    (12 11 2 1 0)
    (12 11 2 1)
    (12 11 2 3)
    (12 11 2 3 4 5)
    (12 11 2 3 4 5 6 7)
    (12 11 2 3 4 5 6 7 8 9)
    (12 11 2 3 4 5 6 7 8 9 10)))

(define (moves-from-11)
  '((11 12)
    (11 2 3 4 13 14)
    (11 2 3 4 13)
    (11 2 3 4 5 6 15 16)
    (11 2 3 4 5 6 15)
    (11 2 3 4 5 6 7 8 17 18)
    (11 2 3 4 5 6 7 8 17)
    (11 2 1 0)
    (11 2 1)
    (11 2 3)
    (11 2 3 4 5)
    (11 2 3 4 5 6 7)
    (11 2 3 4 5 6 7 8 9)
    (11 2 3 4 5 6 7 8 9 10)))

(define (moves-from-10)
  '((10 9 8 7 6 5 4 3 2 11 12)
    (10 9 8 7 6 5 4 3 2 11)
    (10 9 8 7 6 5 4 13 14)
    (10 9 8 7 6 5 4 13)
    (10 9 8 7 6 15 16)
    (10 9 8 7 6 15)
    (10 9 8 17 18)
    (10 9 8 17)
    (10 9 8 7 6 5 4 3 2 1 0)
    (10 9 8 7 6 5 4 3 2 1)
    (10 9 8 7 6 5 4 3)
    (10 9 8 7 6 5)
    (10 9 8 7)
    (10 9)))

(define (moves-from-9)
  '((9 8 7 6 5 4 3 2 11 12)
    (9 8 7 6 5 4 3 2 11)
    (9 8 7 6 5 4 13 14)
    (9 8 7 6 5 4 13)
    (9 8 7 6 15 16)
    (9 8 7 6 15)
    (9 8 17 18)
    (9 8 17)
    (9 8 7 6 5 4 3 2 1 0)
    (9 8 7 6 5 4 3 2 1)
    (9 8 7 6 5 4 3)
    (9 8 7 6 5)
    (9 8 7)
    (9 10)))

(define (moves-from-7)
  '((12 11 2 3 4 5 6)
    (11 2 3 4 5 6)
    (14 13 4 5 6)
    (13 4 5 6)
    (16 15 6)
    (15 6)
    (18 17 8)
    (17 8)
    (0 1 2 3 4 5 6)
    (1 2 3 4 5 6)
    (3 4 5 6)
    (5 6)
    (9 8)
    (10 9 8)))

(define (moves-from-5)
  '((12 11 2 3 4)
    (11 2 3 4)
    (14 13 4)
    (13 4)
    (16 15 6)
    (15 6)
    (18 17 8 7 6)
    (17 8 7 6)
    (0 1 2 3 4)
    (1 2 3 4)
    (3 4)
    (7 6)
    (9 8 7 6)
    (10 9 8 7 6)))

(define (moves-from-3)
  '((12 11 2)
    (11 2)
    (14 13 4)
    (13 4)
    (16 15 6 5 4)
    (15 6 5 4)
    (18 17 8 7 6 5 4)
    (17 8 7 6 5 4)
    (0 1 2)
    (1 2)
    (5 4)
    (7 6 5 4)
    (9 8 7 6 5 4)
    (10 9 8 7 6 5 4)
    ))

(define (moves-from-1)
  '((12 11 2)
    (11 2)
    (14 13 4 3 2)
    (13 4 3 2)
    (16 15 6 5 4 3 2)
    (15 6 5 4 3 2)
    (18 17 8 7 6 5 4 3 2)
    (17 8 7 6 5 4 3 2)
    (0)
    (3 2)
    (5 4 3 2)
    (7 6 5 4 3 2)
    (9 8 7 6 5 4 3 2)
    (10 9 8 7 6 5 4 3 2)))

(define (moves-from-0)
  '((12 11 2 1)
    (11 2 1)
    (14 13 4 3 2 1)
    (13 4 3 2 1)      
    (16 15 6 5 4 3 2 1)
    (15 6 5 4 3 2 1)
    (18 17 8 7 6 5 4 3 2 1)
    (17 8 7 6 5 4 3 2 1)
    (1)
    (3 2 1)
    (5 4 3 2 1)
    (7 6 5 4 3 2 1)
    (9 8 7 6 5 4 3 2 1)
    (10 9 8 7 6 5 4 3 2 1)))

(define (moves-from n)
  (case n
    [(0) (moves-from-0)]
    [(1) (moves-from-1)]
    [(2) '()]
    [(3) (moves-from-3)]
    [(4) '()]
    [(5) (moves-from-5)]
    [(6) '()]
    [(7) (moves-from-7)]
    [(8) '()]
    [(9) (moves-from-9)]
    [(10) (moves-from-10)]
    [(11) (moves-from-11)]
    [(12) (moves-from-12)]
    [(13) (moves-from-13)]
    [(14) (moves-from-14)]))


(define (move-is-blocked state move)
  (let* ([check-occupied (curry is-occupied state)]
         [blocked-spots (filter check-occupied move)])
    (> 0 (length blocked-spots))))
  